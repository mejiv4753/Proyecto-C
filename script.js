const songsData = [
    {
        id: 1,
        title: "Julieta",
        artist: "Latin Mafia",
        audioSrc: "LATIN MAFIA - Julieta.mp3",
        thumb: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTh40b2Uh570cjz-tKXJQ6WPHpkaMQoFY5yHQ&s",
        context: "Me parece que refleja en buena forma la manera en la que destacas y te das a notar en cualquier lugar, siendo tú misma.",
        lyrics: [
            "Con solo una copa de vino",
            "Y una breve charla",
            "Es que yo siempre me descuido",
            "¿Cómo no mirarla?",
            "Tú sabes bailar",
            "Se te facilita como el caminar",
            "Tú sabes bailar",
            "Yeah",
            "Y ese ritmo que lo hace lento",
            "Poco a poco se va a violento",
            "Vamos, vamos, vamos al cielo",
            "Yo no tengo miedo y lo siento",
            "Ya no pongas pretextos",
            "Te vi y tú también me estás viendo",
            "Dime dónde termina el cuento",
            "Si voy por ti o vienes corriendo",
            "Y esa dama",
            "La gente la mira y la ama",
            "Las fotos, vean su llegada",
            "Endulza hasta el agua salada",
            "Endulza hasta el agua salada",
            "La gente espera su llegada",
            "No hay reclamos porque no hay llamadas",
            "Te quiere y si quiere no hay nada",
            "Te quiere y si quiere no hay nada",
            "Tú sabes bailar",
            "Se te facilita como el caminar",
            "Tú sabes bailar",
            "Yeah"
        ],
        timing: [
            20,   // "Con solo una copa de vino"
            22,   // "Y una breve charla"
            25,   // "Es que yo siempre me descuido"
            28,   // "¿Cómo no mirarla?"
            43,   // "Tú sabes bailar"
            45,   // "Se te facilita como el caminar"
            48,   // "Tú sabes bailar"
            52,   // "Yeah"
            53,   // "Y ese ritmo que lo hace lento"
            55,   // "Poco a poco se va a violento"
            58,   // "Vamos, vamos, vamos al cielo"
            60,   // "Yo no tengo miedo y lo siento"
            63,   // "Ya no pongas pretextos"
            65,   // "Te vi y tú también me estás viendo"
            68,   // "Dime dónde termina el cuento"
            70,   // "Si voy por ti o vienes corriendo"
            74,  // "Y esa dama"
            75,  // "La gente la mira y la ama"
            78,  // "Las fotos, vean su llegada"
            81,  // "Endulza hasta el agua salada"
            84,  // "Endulza hasta el agua salada"
            89,  // "La gente espera su llegada"
            94,  // "No hay reclamos porque no hay llamadas"
            100,  // "Te quiere y si quiere no hay nada"
            104,  // "Te quiere y si quiere no hay nada"
            106,  // "Tú sabes bailar"
            108,  // "Se te facilita como el caminar"
            112,  // "Tú sabes bailar"
            115   // "Yeah"
        ]
    },
    {
        id: 2,
        title: "Vivo si me exiges",
        artist: "Latin Mafia",
        audioSrc: "Vivo si me exiges.mp3",
        thumb: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQAfx_wQhHBa6vZ56MMsUedXjfap4g6CNYV7w&s",
        context: "La agregue porque la vida se siente diferente cuando estas tu, mi vida, se siente diferente contigo.",
        lyrics: [
            "¿Desde cuándo hay tantas?",
            "Ya tengo raíces",
            "Siento que me quiebro",
            "Vivo si me exiges",
            "Tú",
            "No tengo nada y todo es tuyo",
            "Si tan solo me lo pides",
            "Tú",
            "Te doy mi vida, aunque sea nada",
            "Sólo espero que te cuides",
            "La manera en que me hablas",
            "Que me haces sentir",
            "Como que ya no hay nada",
            "Que me haga sufrir",
            "Y sólo tú me haces sentir que tengo una granada"
        ],
        timing: [
            24,   // ¿Desde cuándo hay tantas?
            31,   // Ya tengo raíces
            37,   // Siento que me quiebro
            44,   // Vivo si me exiges
            51,  // Tú
            55,  // No tengo nada y todo es tuyo
            57,  // Si tan solo me lo pides
            64,  // Tú
            68,  // Te doy mi vida, aunque sea nada
            70,  // Sólo espero que te cuides
            76,  // La manera en que me hablas
            79,  // Que me haces sentir
            82,  // Como que ya no hay nada
            86,  // Que me haga sufrir
            90   // Y sólo tú me haces sentir que tengo una granada
        ]
    },

    {
        id: 3,
        title: "Sal Rosa",
        artist: "Latin Mafia",
        audioSrc: "Sal Rosa.mp3",
        thumb: "https://i.ytimg.com/vi/ikb5B4SKrss/maxresdefault.jpg",
        context: "Me recuerda al día que nos quedamos hasta tarde madereando, y es que no sé como lo haces pero aun llorando te ves increible, destaco la parte de ´Caricias que no queman, dan calor´, porque me recuerda lo que un día te platiqué: cuando puedo sostener tu mano, la energía se siente diferente.",
        lyrics: [
            "Y no la dejen sola",
            "Está llorando a solas",
            "Pregunta si incomoda",
            "Con tu cigarro sabor a menta",
            "Dulce sabor que luego atormenta",
            "No suelo fumar pero tú me tientas",
            "A ver cómo arde el papel que frecuentas",
            "Con tu cigarro sabor a menta",
            "Dulce sabor que luego atormenta",
            "No suelo fumar pero tú me tientas",
            "A ver cómo arde el papel que frecuentas",
            "Porque con tus besos de agresión",
            "Siento que me ahogo en la obsesión",
            "Caricias que no queman, dan calor",
            "Y es que cuando dueles, duelo yo",
            "Y no la dejen sola",
            "Está llorando a solas",
            "Pregunta si incomoda",
            "Ábrancenla por horas",
            "Soberbia",
            "Le encanta y odia que la miren cuando baila",
            "Sabe que está borracha y aun así va a gritar",
            "Yeah, yeah, yeah",
            "Yeah, una sola vez y pa casa",
            "Otro cigarro que se acaba y que no abraza",
            "Una sola vez y pa casa",
            "Ya no está sola, solo mira para casa"
        ],
        timing: [
            17,   // Y no la dejen sola
            21,   // Está llorando a solas
            25,   // Pregunta si incomoda
            31,   // Con tu cigarro sabor a menta
            35,  // Dulce sabor que luego atormenta
            38,  // No suelo fumar pero tú me tientas
            42,  // A ver cómo arde el papel que frecuentas
            47,  // Con tu cigarro sabor a menta
            51,  // Dulce sabor que luego atormenta
            54,  // No suelo fumar pero tú me tientas
            58,  // A ver cómo arde el papel que frecuentas
            62,  // Porque con tus besos de agresión
            66,  // Siento que me ahogo en la obsesión
            70,  // Caricias que no queman, dan calor
            74,  // Y es que cuando dueles, duelo yo
            80,  // Y no la dejen sola
            83,  // Está llorando a solas
            87,  // Pregunta si incomoda
            91,  // Ábrancenla por horas
            95,  // Soberbia
            96,  // Le encanta y odia que la miren cuando baila
            100,  // Sabe que está borracha y aun así va a gritar
            105,  // Yeah, yeah, yeah
            110,  // Yeah, una sola vez y pa casa
            114,  // Otro cigarro que se acaba y que no abraza
            118, // Una sola vez y pa casa
            122  // Ya no está sola, solo mira para casa
        ]
    },
    {
        id: 4,
        title: "Flores",   // cámbialo si tiene otro título real
        artist: "Latin Mafia", // pon el artista correcto
        audioSrc: "Flores.mp3", // archivo de audio
        thumb: "https://i.ytimg.com/vi/1oOoOJDbhXQ/hq720.jpg?sqp=-oaymwEhCK4FEIIDSFryq4qpAxMIARUAAAAAGAElAADIQj0AgKJD&rs=AOn4CLDQVw7bZCzqKSen-ZURhNyTLcWj4Q",
        context: "Te estoy esperando, Perfuma mi cuerpo, Y que luego te hable, De lo que yo no cuento. Es la parte que me recuerda a tí, pues, eres la única persona a la que podría contarle hasta la minima cosa y sé que estarías ahi para escucharlo.",
        lyrics: [
            "No sé qué pasa, te veo",
            "No se me pasa, te deseo",
            "Llevo tatuado tu aroma entero",
            "Mientras caminas yo te espero",
            "Y no, no, no lo creo",
            "Que bien tú y yo nos vemos",
            "Tú y yo nos vemos, yeah",
            "Te estoy esperando baby, dime dónde",
            "No lo pidas, llevo flores",
            "Mereces flores",
            "Te estoy esperando",
            "Perfuma mi cuerpo",
            "Y que luego te hable",
            "De lo que yo no cuento",
            "Te estoy esperando",
            "Perfuma mi cuerpo",
            "Y que luego te hable",
            "De lo que yo no cuento",
            "Te estoy esperando ho-hoy",
            "Quiero verte hoy",
            "Préstame tus besos",
            "Los devuelvo luego",
            "Sigo pensando qué flores llevar",
            "Dime dónde las paso a dejar",
            "Le llevo una flor a tu mamá",
            "Para agradecer que te vino a crear",
            "Sólo quiero complacerla",
            "Que se sienta toda una reina",
            "Que yo me muero si me besa",
            "Le doy mi vida, si usted me deja",
            "Te estoy esperando baby, dime dónde",
            "Llevo flores, mereces flores"
        ],
        timing: [
            23,   // No sé qué pasa, te veo
            26,   // No se me pasa, te deseo
            28,   // Llevo tatuado tu aroma entero
            31,   // Mientras caminas yo te espero
            33,  // Y no, no, no lo creo
            35,  // Que bien tú y yo nos vemos
            39,  // Tú y yo nos vemos, yeah
            43,  // Te estoy esperando baby, dime dónde
            46,  // No lo pidas, llevo flores
            50,  // Mereces flores
            52,  // Te estoy esperando
            54,  // Perfuma mi cuerpo
            57,  // Y que luego te hable
            59,  // De lo que yo no cuento
            62,  // Te estoy esperando
            64,  // Perfuma mi cuerpo
            67,  // Y que luego te hable
            70,  // De lo que yo no cuento
            72,  // Te estoy esperando ho-hoy
            76,  // Quiero verte hoy
            78,  // Préstame tus besos
            81,  // Los devuelvo luego
            83,  // Sigo pensando qué flores llevar
            85,  // Dime dónde las paso a dejar
            87,  // Le llevo una flor a tu mamá
            90,  // Para agradecer que te vino a crear
            93,  // Sólo quiero complacerla
            95, // Que se sienta toda una reina
            98, // Que yo me muero si me besa
            101, // Le doy mi vida, si usted me deja
            103, // Te estoy esperando baby, dime dónde
            108  // Llevo flores, mereces flores
        ]
    },
    {
        id: 5,
        title: "No digas nada",  // cámbialo si tiene otro título oficial
        artist: "Latin Mafia",           // reemplázalo por el artista correcto
        audioSrc: "No digas nada.mp3", // tu archivo cortado
        thumb: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRzBWIzRqVkxZPw5zUlLWf-e1d9Sugw6QTp3Q&s",
        context: "En este momento es la canción que más siento por el contexto actual, trato de ser cuerdo y darte el mejor de los consejos, pero mente y corazón gritan que no te vayas. La parte de ¿Molestar en abrazarme? Créeme, no es molestia, va a sanarme; es la definición tal cuál de lo que cada abrazo que nos hemos dado significa para mí.",
        lyrics: [
            "El hombre más desnudo está hablando",
            "El hombre me habla",
            "Please, please, please, please (silence, please)",
            "Ay, no (yeah)",
            "No digas nada",
            "Creo que la ropa ya está pesada",
            "Soñar más lindo contigo de almohada, yeah",
            "Si no estás tú (woah) (yeah)",
            "¿Cómo estoy yo?",
            "Si no estás tú (woah)",
            "Mejor no estoy",
            "Porfa, entiéndeme, ya estuve roto",
            "Un hombre más llorando, todos saquen fotos",
            "Aquí estamo' ayer, pensando en todo",
            "El plan no era hablar y nos contamos todo",
            "¿Molestar en abrazarme?",
            "Créeme, no es molestia, va a sanarme",
            "El hombre más desnudo está intentando hablarte",
            "Con pocas palabras porque lo han muteao' bastante",
            "Lo han callado bastante (yeah)",
            "Creo que la ropa ya está pesada",
            "(Soñar más lindo contigo de almohada)",
            "Si no estás tú (si no estás tú)",
            "¿Cómo estoy yo?",
            "Si no estás tú (si no estás tú)",
            "Mejor no estoy",
            "No me siento mal (yeah), me siento raro",
            "Es diferente, eso sí, lo tengo claro",
            "Prendo un cigarro, y yo ya no fumo",
            "Pero si a ti te gusta, ven, te paso el humo",
            "Tómame la mano (yeah), abrázame fuerte",
            "Soy quien demuestra como adulto, pero como un niño siente",
            "Préstame un espacio, pero que sea de esos",
            "De unos que no siente",
            "Y se le olvida cuán mierda la ha estado pasando",
            "Dicen que todo pasa y me estoy apagando",
            "Me estoy apagando"
        ],
        timing: [
            9,   // El hombre más desnudo está hablando
            13,   // El hombre me habla
            15,   // Please, please, please, please (silence, please)
            17,   // Ay, no (yeah)
            21,  // No digas nada
            24,  // Creo que la ropa ya está pesada
            28,  // Soñar más lindo contigo de almohada, yeah
            34,  // Si no estás tú (woah) (yeah)
            38,  // ¿Cómo estoy yo?"
            42,  // Si no estás tú (woah)
            47,  // Mejor no estoy
            51,  // Porfa, entiéndeme, ya estuve roto
            56,  // Un hombre más llorando, todos saquen fotos
            60,  // Aquí estamo' ayer, pensando en todo
            64,  // El plan no era hablar y nos contamos todo
            69,  // ¿Molestar en abrazarme?
            72,  // Créeme, no es molestia, va a sanarme
            75,  // El hombre más desnudo está intentando hablarte
            79,  // Con pocas palabras porque lo han muteao' bastante
            84,  // Lo han callado bastante (yeah)
            94,  // Creo que la ropa ya está pesada
            98,  // (Soñar más lindo contigo de almohada)
            104,  // Si no estás tú (si no estás tú)
            108,  // ¿Cómo estoy yo?
            113,  // Si no estás tú (si no estás tú)
            117,  // Mejor no estoy
            120,  // No me siento mal (yeah), me siento raro
            125, // Es diferente, eso sí, lo tengo claro
            130, // Prendo un cigarro, y yo ya no fumo
            134, // Pero si a ti te gusta, ven, te paso el humo
            139, // Tómame la mano (yeah), abrázame fuerte
            143, // Soy quien demuestra como adulto, pero como un niño siente
            148, // Préstame un espacio, pero que sea de esos
            153, // De unos que no siente
            156, // Y se le olvida cuán mierda la ha estado pasando
            163, // Dicen que todo pasa y me estoy apagando
            169  // Me estoy apagando
        ]
    },
    {
        id: 6,
        title: "Patadas de ahogado", // cámbialo si tiene otro título oficial
        artist: "Latin Mafia",         // pon el artista correcto
        audioSrc: "Patadas de ahogado.mp3",
        thumb: "https://i1.sndcdn.com/artworks-w1WDWsSRoS1b-0-t500x500.jpg",
        context: "De nuevo con los abrazos, es increible la fácilidad con la que puedo darte uno o dos, incluso más si me los pides, creo que se nota mucho que no me quiero despegar cuando nos hemos abrazado (perdón), pero siento paz, tranquilidad, el ruido de mi cabeza para y todo se vuelve menos malo. Pd: Apapachame significa abrazar con el alma y el corazón",
        lyrics: [
            "Tú hueles a vainilla, te quiero",
            "Dale, abrázame otro rato",
            "Déjame te soy sincero",
            "Tiene tiempo que yo trato",
            "Llevaba tiempo buscando a quién cantarle",
            "Sobre cuando me siento vulnerable",
            "Dale, abrázame otro rato",
            "Apapáchame la vida entera",
            "Quiero saberte a lo que quieres",
            "Llorar por lo que te hace llorar",
            "Ser música de la que prefieres",
            "Y que nunca me quieras pausar",
            "Quiero saberte a lo que quieres",
            "Llorar por lo que te hace llorar",
            "Ser música de la que prefieres",
            "Y que nunca me quieras pausar",
            "Aventando patadas de ahogado (ahogado)",
            "Sin saber si la armamos, seguimos nadando (nadando)",
            "Por ti sigo tratando, cavando",
            "Regando las flores que de viejos nos veo fumando"
        ],
        timing: [
            4,   // Tú hueles a vainilla, te quiero
            9,   // Dale, abrázame otro rato
            15,   // Déjame te soy sincero
            20,  // Tiene tiempo que yo trato
            25,  // Llevaba tiempo buscando a quién cantarle
            31,  // Sobre cuando me siento vulnerable
            36,  // Dale, abrázame otro rato
            41,  // Apapáchame la vida entera
            42,  // Quiero saberte a lo que quieres
            45,  // Llorar por lo que te hace llorar
            48,  // Ser música de la que prefieres
            50,  // Y que nunca me quieras pausar
            53,  // Quiero saberte a lo que quieres
            56,  // Llorar por lo que te hace llorar
            58,  // Ser música de la que prefieres
            61,  // Y que nunca me quieras pausar
            64,  // Aventando patadas de ahogado (ahogado)
            69,  // Sin saber si la armamos, seguimos nadando (nadando)
            74,  // Por ti sigo tratando, cavando
            79   // Regando las flores que de viejos nos veo fumando
        ]
    },
    {
        id: 7,
        title: "Continuo Atardecer",
        artist: "Latin Mafia",
        audioSrc: "Continuo Atardecer.mp3", // asegúrate de subirlo a tu repo
        thumb: "https://s.mxmcdn.net/images-storage/albums2/8/3/0/3/6/9/63963038_500_500.jpg",
        context: ` Finalmente esta canción me recuerda a ti por el hecho de todo lo que has enfrentado y el cómo has salido adelante, sé que esto es solo una etapa más que te servirá de experiencia, una que te dará el coraje para seguir construyendo a la grandiosa mujer que ya eres.

Tal vez ya enfadé mucho con la música de Latín, pero la neta los vatos escribieron las canciones con el corazón y así como ellos, escribo todo esto, gracias por estar y convertir mis peores días en los mejores, gracias por enseñarme que divertirse no es malo y justo por eso no encuentro mejor palabra que serendipia, que significa encontrar algo valioso de forma accidental, es decir sin buscarlo y tú eres eso valioso, ya que en ti encontré la paz y tranquilidad que necesitaba, pues, como ya mencioné muchas veces, contigo la vida, la energía, las emociones, se sienten diferentes.

Si algún día tienes que irte, lo entenderé, pero no me quedaré esperando tu regreso, Iré a buscarte, aunque te vayas a Japón o a la Antártida, porque tú eres esa persona por la que sí vale la pena hacer todo lo posible.`,
        lyrics: [
            "Continuo atardecer",
            "Corre por su piel, yeah",
            "Sabe bien qué hacer",
            "Para verse bien",
            "Se arregla para ella misma",
            "Salió con todas sus amigas",
            "Ey, vestido corto que le queda bien",
            "Esa niña siempre luce bien",
            "Aprendió a sentirse siempre como un diez",
            "No le tiene miedo a lo que fue ayer",
            "Yeah y si le tiene miedo",
            "No importa, tiene tiempo pa' entenderlo",
            "Sus cicatrices se volvieron lienzos",
            "En cada herida se dio un beso",
            "El espejo la adora",
            "Siempre se ve mona",
            "Con su look de Barbie",
            "Pero es bien cabrona",
            "No le tiene miedo a lo que fue ayer",
            "No le tiene miedo a lo que fue ayer",
            "No le tiene miedo a lo que fue ayer",
            "No le tiene miedo a lo que fue ayer"
        ],
        timing: [
            12,   // "Continuo atardecer"
            15,   // "Corre por su piel, yeah"
            19,   // "Sabe bien qué hacer"
            22,  // "Para verse bien"
            24,  // "Se arregla para ella misma"
            26,  // "Salió con todas sus amigas"
            29,  // "Ey, vestido corto que le queda bien"
            32,  // "Esa niña siempre luce bien"
            34,  // "Aprendió a sentirse siempre como un diez"
            37,  // "No le tiene miedo a lo que fue ayer"
            39,  // "Yeah y si le tiene miedo"
            42,  // "No importa, tiene tiempo pa' entenderlo"
            44,  // "Sus cicatrices se volvieron lienzos"
            46,  // "En cada herida se dio un beso"
            49,  // "El espejo la adora"
            50,  // "Siempre se ve mona"
            53,  // "Con su look de Barbie"
            55,  // "Pero es bien cabrona"
            60,  // "No le tiene miedo a lo que fue ayer"
            64,  // "No le tiene miedo a lo que fue ayer"
            69,  // "No le tiene miedo a lo que fue ayer"
            74   // "No le tiene miedo a lo que fue ayer"
        ]
    }
];

// Estado de la app
let state = {
    currentlyPlaying: null,
    currentPage: 1,
    songsPerPage: 3,
    totalPages: 1
};

// // Inicializar app
// document.addEventListener('DOMContentLoaded', () => {
//     state.totalPages = Math.ceil(songsData.length / state.songsPerPage);
//     renderSongs();
//     setupEventListeners();
//     updatePaginationInfo();

//     // Configurar modal de contexto
//     const modal = document.getElementById('context-modal');
//     const closeBtn = document.getElementById('close-context');

//     closeBtn.addEventListener('click', () => {
//         modal.style.display = 'none';
//     });

//     window.addEventListener('click', (event) => {
//         if (event.target === modal) {
//             modal.style.display = 'none';
//         }
//     });
// });
// Inicializar app
document.addEventListener('DOMContentLoaded', () => {
    state.totalPages = Math.ceil(songsData.length / state.songsPerPage);
    renderSongs();
    setupEventListeners();
    updatePaginationInfo();

    // Configurar modal de contexto
    const modal = document.getElementById('context-modal');
    const closeBtn = document.getElementById('close-context');

    closeBtn.addEventListener('click', () => {
        modal.style.display = 'none';
    });

    window.addEventListener('click', (event) => {
        if (event.target === modal) {
            modal.style.display = 'none';
        }
    });
});

// Renderizar canciones
// function renderSongs() {
//     const container = document.getElementById('songs-container');
//     container.innerHTML = '';

//     const start = (state.currentPage - 1) * state.songsPerPage;
//     const end = start + state.songsPerPage;

//     songsData.slice(start, end).forEach(song => {
//         const card = document.createElement('div');
//         card.classList.add('song-card');
//         card.id = `song-${song.id}`;

//         card.innerHTML = `
//             <div class="song-header">
//                 <div class="song-thumb" style="background-image: url('${song.thumb}')"></div>
//                 <div class="song-info">
//                     <div class="song-title">${song.title}</div>
//                     <div class="song-artist">${song.artist}</div>
//                 </div>
//             </div>

//             <div class="lyrics-container">
//                 ${song.lyrics.map(line => `<div class="lyrics-line">${line}</div>`).join('')}
//             </div>

//             <div class="playback-controls">
//                 <button class="play-btn" onclick="togglePlayback(${song.id})">
//                     <i class="fas fa-play"></i> Reproducir
//                 </button>
//                 <button class="context-btn" onclick="showContext(${song.id})">
//                     <i class="fas fa-info-circle"></i> Contexto
//                 </button>
//             </div>

//             <div class="audio-player">
//                 <audio id="audio-${song.id}" preload="metadata">
//                     <source src="${song.audioSrc}" type="audio/mpeg">
//                     Tu navegador no soporta el elemento de audio.
//                 </audio>
//                 <div class="progress-container" onclick="seek(${song.id}, event)">
//                     <div class="progress-bar" id="progress-bar-${song.id}"></div>
//                 </div>
//                 <div class="time-display">
//                     <span id="current-time-${song.id}">00:00</span>
//                     <span id="duration-${song.id}">00:00</span>
//                 </div>
//                 <div class="volume-control">
//                     <i class="fas fa-volume-up"></i>
//                     <input type="range" id="volume-${song.id}" min="0" max="1" step="0.01" value="0.7" oninput="setVolume(${song.id}, this.value)">
//                 </div>
//             </div>
//         `;

//         const audioEl = card.querySelector(`#audio-${song.id}`);
//         audioEl.addEventListener('loadedmetadata', () => {
//             document.getElementById(`duration-${song.id}`).textContent = formatTime(audioEl.duration);
//         });
//         audioEl.addEventListener('timeupdate', () => {
//             updateProgress(song.id);
//             highlightLyrics(song.id);
//         });
//         audioEl.addEventListener('ended', () => resetPlayback(song.id));

//         container.appendChild(card);
//     });
// }
// Renderizar canciones
function renderSongs() {
    const container = document.getElementById('songs-container');
    container.innerHTML = '';

    // Verificar si es la última página
    const isLastPage = state.currentPage === state.totalPages;

    // Aplicar clase especial para la última página
    if (isLastPage) {
        container.classList.add('last-page-layout');
    } else {
        container.classList.remove('last-page-layout');
    }

    const start = (state.currentPage - 1) * state.songsPerPage;
    const end = start + state.songsPerPage;

    songsData.slice(start, end).forEach(song => {
        const card = document.createElement('div');
        card.classList.add('song-card');
        card.id = `song-${song.id}`;

        // Para la última página, solo mostrar la primera canción en el layout especial
        if (isLastPage && song.id === songsData[songsData.length - 1].id) {
            card.innerHTML = `
                <div class="song-header">
                    <div class="song-thumb" style="background-image: url('${song.thumb}')"></div>
                    <div class="song-info">
                        <div class="song-title">${song.title}</div>
                        <div class="song-artist">${song.artist}</div>
                    </div>
                </div>

                <div class="lyrics-container">
                    ${song.lyrics.map(line => `<div class="lyrics-line">${line}</div>`).join('')}
                </div>

                <div class="playback-controls">
                    <button class="play-btn" onclick="togglePlayback(${song.id})">
                        <i class="fas fa-play"></i> Reproducir
                    </button>
                </div>

                <div class="audio-player">
                    <audio id="audio-${song.id}" preload="metadata">
                        <source src="${song.audioSrc}" type="audio/mpeg">
                        Tu navegador no soporta el elemento de audio.
                    </audio>
                    <div class="progress-container" onclick="seek(${song.id}, event)">
                        <div class="progress-bar" id="progress-bar-${song.id}"></div>
                    </div>
                    <div class="time-display">
                        <span id="current-time-${song.id}">00:00</span>
                        <span id="duration-${song.id}">00:00</span>
                    </div>
                    <div class="volume-control">
                        <i class="fas fa-volume-up"></i>
                        <input type="range" id="volume-${song.id}" min="0" max="1" step="0.01" value="0.7" oninput="setVolume(${song.id}, this.value)">
                    </div>
                </div>
            `;

            // Configurar event listeners para el audio en la última página
            setTimeout(() => {
                const audioEl = document.getElementById(`audio-${song.id}`);
                if (audioEl) {
                    audioEl.addEventListener('loadedmetadata', () => {
                        const durationEl = document.getElementById(`duration-${song.id}`);
                        if (durationEl) {
                            durationEl.textContent = formatTime(audioEl.duration);
                        }
                    });
                    audioEl.addEventListener('timeupdate', () => {
                        updateProgress(song.id);
                        highlightLyrics(song.id);
                    });
                    audioEl.addEventListener('ended', () => resetPlayback(song.id));
                }
            }, 0);

            // Crear el panel de contexto para la última página
            const contextPanel = document.createElement('div');
            contextPanel.classList.add('last-page-context');
            contextPanel.innerHTML = `
                <h3>¿Por qué "${song.title}"?</h3>
                <p>${song.context}</p>
            `;

            container.appendChild(card);
            container.appendChild(contextPanel);
        } else {
            // Layout normal para las demás páginas
            card.innerHTML = `
                <div class="song-header">
                    <div class="song-thumb" style="background-image: url('${song.thumb}')"></div>
                    <div class="song-info">
                        <div class="song-title">${song.title}</div>
                        <div class="song-artist">${song.artist}</div>
                    </div>
                </div>

                <div class="lyrics-container">
                    ${song.lyrics.map(line => `<div class="lyrics-line">${line}</div>`).join('')}
                </div>

                <div class="playback-controls">
                    <button class="play-btn" onclick="togglePlayback(${song.id})">
                        <i class="fas fa-play"></i> Reproducir
                    </button>
                    <button class="context-btn" onclick="showContext(${song.id})">
                        <i class="fas fa-info-circle"></i> Contexto
                    </button>
                </div>

                <div class="audio-player">
                    <audio id="audio-${song.id}" preload="metadata">
                        <source src="${song.audioSrc}" type="audio/mpeg">
                        Tu navegador no soporta el elemento de audio.
                    </audio>
                    <div class="progress-container" onclick="seek(${song.id}, event)">
                        <div class="progress-bar" id="progress-bar-${song.id}"></div>
                    </div>
                    <div class="time-display">
                        <span id="current-time-${song.id}">00:00</span>
                        <span id="duration-${song.id}">00:00</span>
                    </div>
                    <div class="volume-control">
                        <i class="fas fa-volume-up"></i>
                        <input type="range" id="volume-${song.id}" min="0" max="1" step="0.01" value="0.7" oninput="setVolume(${song.id}, this.value)">
                    </div>
                </div>
            `;

            const audioEl = card.querySelector(`#audio-${song.id}`);
            audioEl.addEventListener('loadedmetadata', () => {
                document.getElementById(`duration-${song.id}`).textContent = formatTime(audioEl.duration);
            });
            audioEl.addEventListener('timeupdate', () => {
                updateProgress(song.id);
                highlightLyrics(song.id);
            });
            audioEl.addEventListener('ended', () => resetPlayback(song.id));

            container.appendChild(card);
        }
    });

    // Asegurarse de que solo hay una canción en la última página
    if (isLastPage) {
        state.songsPerPage = 1;
    } else {
        state.songsPerPage = 3;
    }
}

// Funciones de reproducción
function togglePlayback(songId) {
    if (state.currentlyPlaying === songId) {
        pausePlayback(songId);
        return;
    }
    if (state.currentlyPlaying) pausePlayback(state.currentlyPlaying);
    playPlayback(songId);
}

function playPlayback(songId) {
    const audio = document.getElementById(`audio-${songId}`);
    const card = document.getElementById(`song-${songId}`);
    const btn = card.querySelector('.play-btn');

    audio.play();
    card.classList.add('playing');
    btn.innerHTML = '<i class="fas fa-pause"></i> Pausar';
    state.currentlyPlaying = songId;
}

function pausePlayback(songId) {
    const audio = document.getElementById(`audio-${songId}`);
    const card = document.getElementById(`song-${songId}`);
    const btn = card.querySelector('.play-btn');

    audio.pause();
    card.classList.remove('playing');
    btn.innerHTML = '<i class="fas fa-play"></i> Reproducir';
    if (state.currentlyPlaying === songId) state.currentlyPlaying = null;
}

function resetPlayback(songId) {
    pausePlayback(songId);
    const audio = document.getElementById(`audio-${songId}`);
    audio.currentTime = 0;

    const card = document.getElementById(`song-${songId}`);
    card.querySelectorAll('.lyrics-line').forEach(line => line.classList.remove('current-line'));
}

// Funciones de barra de progreso y letra
function updateProgress(songId) {
    const audio = document.getElementById(`audio-${songId}`);
    const progressBar = document.getElementById(`progress-bar-${songId}`);
    const currentTimeEl = document.getElementById(`current-time-${songId}`);

    const percent = (audio.currentTime / audio.duration) * 100;
    progressBar.style.width = `${percent}%`;
    currentTimeEl.textContent = formatTime(audio.currentTime);
}

function highlightLyrics(songId) {
    const audio = document.getElementById(`audio-${songId}`);
    const card = document.getElementById(`song-${songId}`);
    const song = songsData.find(s => s.id === songId);
    if (!song || !song.timing) return;

    let currentLine = 0;
    for (let i = song.timing.length - 1; i >= 0; i--) {
        if (audio.currentTime >= song.timing[i]) {
            currentLine = i;
            break;
        }
    }

    const lines = card.querySelectorAll('.lyrics-line');
    lines.forEach((line, index) => {
        line.classList.toggle('current-line', index === currentLine);
        if (index === currentLine) line.scrollIntoView({ behavior: 'smooth', block: 'center' });
    });
}

// Funciones de interacción
function seek(songId, event) {
    const audio = document.getElementById(`audio-${songId}`);
    const progress = document.getElementById(`song-${songId}`).querySelector('.progress-container');
    const clickX = event.offsetX;
    const width = progress.clientWidth;
    audio.currentTime = (clickX / width) * audio.duration;
}

function setVolume(songId, value) {
    document.getElementById(`audio-${songId}`).volume = value;
}

function formatTime(seconds) {
    if (isNaN(seconds)) return "00:00";
    const mins = Math.floor(seconds / 60);
    const secs = Math.floor(seconds % 60);
    return `${String(mins).padStart(2, '0')}:${String(secs).padStart(2, '0')}`;
}

// Mostrar contexto de la canción
function showContext(songId) {
    const song = songsData.find(s => s.id === songId);
    if (!song) return;

    const modal = document.getElementById('context-modal');
    const title = document.getElementById('context-song-title');
    const text = document.getElementById('context-text');

    title.textContent = `${song.title} - ${song.artist}`;
    text.textContent = song.context;

    modal.style.display = 'flex';
}

// Paginación
function setupEventListeners() {
    document.getElementById('prev-page').addEventListener('click', () => changePage('prev'));
    document.getElementById('next-page').addEventListener('click', () => changePage('next'));
}

// function changePage(dir) {
//     if (dir === 'next' && state.currentPage < state.totalPages) state.currentPage++;
//     else if (dir === 'prev' && state.currentPage > 1) state.currentPage--;
//     else return;

//     if (state.currentlyPlaying) pausePlayback(state.currentlyPlaying);
//     renderSongs();
//     updatePaginationInfo();
// }
function changePage(dir) {
    if (dir === 'next' && state.currentPage < state.totalPages) state.currentPage++;
    else if (dir === 'prev' && state.currentPage > 1) state.currentPage--;
    else return;

    if (state.currentlyPlaying) pausePlayback(state.currentlyPlaying);
    renderSongs();
    updatePaginationInfo();
}

function updatePaginationInfo() {
    document.getElementById('current-page').textContent = state.currentPage;
    document.getElementById('total-pages').textContent = state.totalPages;
    document.getElementById('prev-page').style.visibility = state.currentPage > 1 ? 'visible' : 'hidden';
    document.getElementById('next-page').style.visibility = state.currentPage < state.totalPages ? 'visible' : 'hidden';
}